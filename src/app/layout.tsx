'use client'

import { Header } from '@/components/Header'
import '../styles/globals.css'
import type { Metadata } from 'next'
import { AuthContextProvider } from '@/contexts/AuthContext'
import { usePathname } from 'next/navigation'
import { checkIsPublicRoute } from '@/config/check-is-public-route'
import PrivateRoute from '@/components/PrivateRoute/PrivateRoute'
import { UpdateProfileContextProvider } from '@/contexts/UpdateProfileContext'

export const metadata: Metadata = {
  title: 'Create Next App',
  description: 'Generated by create next app',
}

export default function RootLayout({
  children,
}: {
  children: React.ReactNode
}) {
  const pathname = usePathname()
  const isPublicPage = checkIsPublicRoute(pathname)

  return (
    <html lang="pt-BR">
      <body className="bg-rose-200 p-4">
        <div className="rounded-xl max-w-[150rem] mx-auto my-auto">
          {isPublicPage && (
            <AuthContextProvider>
              <UpdateProfileContextProvider>
                <Header />
                {children}
              </UpdateProfileContextProvider>
            </AuthContextProvider>
          )}
          {!isPublicPage && (
            <AuthContextProvider>
              <UpdateProfileContextProvider>
                <Header />
                <PrivateRoute>{children}</PrivateRoute>
              </UpdateProfileContextProvider>
            </AuthContextProvider>
          )}
        </div>
      </body>
    </html>
  )
}
